# =============================================================
# CorpusVisualize Pipeline Configuration (.env.sample)
# -------------------------------------------------------------
# 1. ファイルをコピーして `.env` として保存すると自動で読み込まれます。
# 2. ここに記載の値は必要に応じて変更してください（未使用ならコメントでOK）。
# =============================================================

# -------------------------
# パイプライン共通
# -------------------------
# 入力音声ディレクトリ (CLI でファイルを直接指定する場合は無視されます)
CV_INPUT_DIR=data/wav
# 出力ルート (segments.jsonl, speakers.parquet, comparison HTML など)
CV_OUTPUT_DIR=output/pipeline

# 使用する ASR / 話者分離
CV_ASR=quick                # quick / whisper-xxx / dummy など
CV_DIARIZATION=quick_cluster# quick_cluster / pyannote / energy など
CV_LANGUAGE=ja              # Whisper 言語ヒント (例: ja, en)

# セグメント長やリサンプリング設定
CV_MIN_SEG_SEC=1.0
CV_MAX_SEG_SEC=20.0
CV_SAMPLE_RATE=16000

# 感情・韻律系バックエンド
CV_SER_BACKEND=speechbrain   # speechbrain / dummy
CV_PROSODY_BACKEND=unidic    # unidic / none
CV_WORD_PITCH_BACKEND=pyworld# pyworld / librosa / none

# LLM で発話補正したい場合の設定
CV_LLM_ENABLED=1
CV_LLM_BASE_URL=http://192.168.40.182:1234/v1
CV_LLM_MODEL=openai/gpt-oss-20b
CV_LLM_MAX_TOKENS=512
CV_LLM_TEMPERATURE=0.2
# キーが必要な場合のみ設定
CV_LLM_API_KEY=

# Pyannote を使う場合の HuggingFace トークン
PYANNOTE_AUDIO_AUTH_TOKEN=hf_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -------------------------
# Quick Cluster (再利用用アーティファクト作成) 共通設定
# -------------------------
# Quick 用の成果物は `CV_OUTPUT_DIR/<会話ID>` の中にそのまま生成されます。
# ここでは Whisper やクラスタリング関連のパラメータのみ調整してください。

# Whisper 設定
WHISPER_MODEL=large-v3-turbo
WHISPER_LANGUAGE=ja
WHISPER_DEVICE=auto          # auto / cpu / cuda
WHISPER_NO_CONDITION=1       # 1=前文脈を使わない
WHISPER_NO_WORDS=0           # 1=words.jsonl を出力しない

# ECAPA / PCA / クラスタリング設定
HMD_SPEAKER_SR=16000
HMD_PREPROCESS=zscore_l2     # raw / zscore / l2 / zscore_l2 / whiten
HMD_PCA_DIMS=50
HMD_PCA_EVAL=50d             # 2d / 50d
HMD_K_MIN=2
HMD_K_MAX=12
HMD_RANDOM_STATE=42
HMD_KMEANS_N_INIT=auto
HMD_SILHOUETTE_METRIC=euclidean
HMD_MIN_SEGMENTS=4

# Quick Cluster 出力オプション
HMD_OVERWRITE=1              # 1=既存フォルダを上書き
HMD_SAVE_HTML=1
HMD_SAVE_PNG=1
HMD_REUSE_SEGMENTS=1         # 既存 segments.jsonl があれば ASR をスキップ

# -------------------------
# その他 (必要に応じて)
# -------------------------
# CV_REF_DIR=path/to/reference        # 比較 HTML 用リファレンスディレクトリ
# CV_COMPARISON_HTML=1                # 比較 HTML 出力 ON/OFF (1/0)
# CV_COMPARISON_THEME=light           # light / dark
